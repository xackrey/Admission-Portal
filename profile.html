<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Profile - LYFJRSHS</title>
<style>
body {
    margin:0;
    font-family:Arial,sans-serif;
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    background:url('image.jpg') no-repeat center center fixed;
    background-size:cover;
}
.container {
  background: linear-gradient(145deg, #ffffffdd, #f0f0f0dd);
  width: 95%;
  max-width: 800px;
  border-radius: 15px;
  padding: 30px;
  margin: 30px 0;
  box-shadow: 0 6px 20px rgba(0,0,0,0.3);
}
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}
.header h2 { margin: 0; color: #2c3e50; }
.logout-btn {
  padding: 10px 20px;
  font-size: 16px;
  background-color: #e74c3c;
  color: #fff;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: 0.3s;
}
.logout-btn:hover { background-color: #c0392b; }

.profile-card {
  display: flex;
  gap: 20px;
  background: #fff;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.2);
}
.profile-card img {
  width: 150px;
  height: 150px;
  object-fit: cover;
  border-radius: 8px;
  border: 2px solid #4caf50;
}
.profile-details {
  flex: 1;
}
.profile-details h3 {
  margin-top: 0;
  color: #4caf50;
}
.profile-details p {
  margin: 5px 0;
  font-weight: bold;
}
</style>
</head>
<body>

<div class="container">
  <div class="header">
    <h2>Student Profile</h2>
    <button class="logout-btn" id="logout">Logout</button>
  </div>

  <div class="profile-card">
    <img id="profilePhoto" src="logo.jpg" alt="Profile Photo">
    <div class="profile-details">
      <h3 id="fullName">Full Name</h3>
      <p><b>LRN:</b> <span id="lrn">N/A</span></p>
      <p><b>Date of Birth:</b> <span id="dob">N/A</span></p>
      <p><b>Place of Birth:</b> <span id="birthPlace">N/A</span></p>
      <p><b>Sex:</b> <span id="sex">N/A</span></p>
      <p><b>Email:</b> <span id="email">N/A</span></p>
      <p><b>Phone:</b> <span id="phone">N/A</span></p>
      <p><b>Barangay:</b> <span id="barangay">N/A</span></p>
      <p><b>City / Municipality:</b> <span id="city">N/A</span></p>
      <p><b>Province:</b> <span id="province">N/A</span></p>
      <p><b>Region:</b> <span id="region">N/A</span></p>
      <p><b>Zip Code:</b> <span id="zip">N/A</span></p>
      <p><b>Strand:</b> <span id="strand">N/A</span></p>
      <p><b>Specialization:</b> <span id="specialization">N/A</span></p>
    </div>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey:"AIzaSyBd0qUeuZr68Cf10bomf0mQEcjuNaE6Krs",
  authDomain:"admissionportal-ec954.firebaseapp.com",
  projectId:"admissionportal-ec954"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Logout button
document.getElementById('logout').addEventListener('click', ()=>{
  window.location.href = 'index.html';
});

// Get UID from URL
const params = new URLSearchParams(window.location.search);
const uid = params.get("uid");
if(!uid){ alert("No UID found!"); }

const docRef = doc(db,"applications",uid);
const docSnap = await getDoc(docRef);
if(docSnap.exists()){
  const data = docSnap.data();
  document.getElementById("profilePhoto").src = data.photo || "logo.jpg";
  document.getElementById("fullName").textContent = `${data.givenName} ${data.middleName||''} ${data.surname}`;
  document.getElementById("lrn").textContent = data.lrn || "N/A";
  document.getElementById("dob").textContent = data.dob || "N/A";
  document.getElementById("birthPlace").textContent = data.birthPlace || "N/A";
  document.getElementById("sex").textContent = data.sex || "N/A";
  document.getElementById("email").textContent = data.email || "N/A";
  document.getElementById("phone").textContent = data.phone || "N/A";
  document.getElementById("barangay").textContent = data.location?.barangay || "N/A";
  document.getElementById("city").textContent = data.location?.city || "N/A";
  document.getElementById("province").textContent = data.location?.province || "N/A";
  document.getElementById("region").textContent = data.location?.region || "N/A";
  document.getElementById("zip").textContent = data.location?.zip || "N/A";
  document.getElementById("strand").textContent = data.strand || "N/A";
  document.getElementById("specialization").textContent = data.specialization || "N/A";
} else {
  alert("Profile not found!");
}
</script>

</body>
</html>
