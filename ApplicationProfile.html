<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Register Form - LYFJRSHS</title>
<script src="https://accounts.google.com/gsi/client" async defer></script>
<style>
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  margin: 0;
  padding: 0;
  background: linear-gradient(135deg,#6a11cb,#2575fc);
  display: flex;
  justify-content: center;
  align-items: flex-start;
  min-height: 100vh;
}
.container {
  background: linear-gradient(145deg,#ffffffdd,#f0f0f0dd);
  width: 95%;
  max-width: 700px;
  border-radius: 15px;<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SHS Enrollment Form - LYFJRSHS</title>
<style>
body{
  margin:0;
  font-family:'Segoe UI', sans-serif;
  background: linear-gradient(135deg,#4CAF50,#F44336);
  display:flex;
  justify-content:center;
  padding:30px 0;
}
.container{
  background:#fff;
  width:90%;
  max-width:850px;
  border-radius:20px;
  padding:40px 50px;
  box-shadow:0 12px 25px rgba(0,0,0,0.3);
  border-top:8px solid #4CAF50;
  border-bottom:8px solid #F44336;
}
header{text-align:center;margin-bottom:25px;}
header img{
  width:90px;
  margin:0 auto 10px auto;
  display:block;
  border-radius:50%;      /* circular logo */
  border:3px solid #4CAF50;
  object-fit:cover;
}
h1{font-size:30px;font-weight:bold;color:#2c3e50;}
h3{margin-top:25px;border-bottom:2px solid #ccc;padding-bottom:5px;color:#2c3e50;font-size:20px;}
label{display:block;margin-top:10px;font-weight:bold;cursor:pointer;}
input[type="text"], input[type="date"], input[type="email"], input[type="tel"], select{
  width:100%;
  padding:10px;
  margin-top:5px;
  border-radius:6px;
  border:1px solid #3498db;
  box-sizing:border-box;
}
input[type="radio"], input[type="checkbox"]{margin-right:6px;}
.section{
  margin-top:15px;
  padding:15px;
  border:1px solid #ccc;
  border-radius:12px;
  background:#f9f9f9;
}
.nested-specialization{
  margin-left:25px;
  margin-top:10px;
  display:none;
}
button{
  margin-top:25px;
  width:100%;
  padding:15px;
  border:none;
  border-radius:8px;
  background:linear-gradient(90deg,#4CAF50,#F44336);
  color:white;
  font-weight:bold;
  font-size:16px;
  cursor:pointer;
  transition:0.3s;
}
button:disabled{background:gray;cursor:not-allowed;}
button:hover:not(:disabled){opacity:0.9;}
@media(max-width:600px){
  .container{padding:30px 20px;}
  h1{font-size:24px;}
  h3{font-size:18px;}
}
</style>
</head>
<body>

<div class="container">
<header>
  <img src="logo.jpg" alt="School Logo">
  <h1>Register Form</h1>
</header>

<form id="shsForm">
<h3>Personal Information</h3>
<label>LRN</label><input type="text" id="lrn" pattern="[0-9]{12}" maxlength="12" required>
<label>Given Name</label><input type="text" id="givenName" required>
<label>Middle Name</label><input type="text" id="middleName">
<label>Surname</label><input type="text" id="surname" required>
<label>Date of Birth</label><input type="date" id="dob" required>
<label>Place of Birth</label><input type="text" id="birthPlace" required>
<label>Sex</label>
<select id="sex" required><option value="">Select</option><option>Male</option><option>Female</option></select>
<label>Email</label><input type="email" id="email" required>
<label>Phone</label><input type="tel" id="phone" required>

<h3>Location</h3>
<label>Barangay</label><input type="text" id="barangay" required>
<label>Municipality / City</label><input type="text" id="city" required>
<label>Province</label><input type="text" id="province" required>
<label>Region</label><input type="text" id="region" required>
<label>Zip Code</label><input type="text" id="zip" required>

<h3>Strand</h3>
<div id="strandSection" class="section"></div>
<div id="specializationSection" class="section"></div>

<button type="submit" id="submitBtn">Submit Form</button>
</form>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey:"AIzaSyBd0qUeuZr68Cf10bomf0mQEcjuNaE6Krs",
  authDomain:"admissionportal-ec954.firebaseapp.com",
  projectId:"admissionportal-ec954"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

/* STRAND OPTIONS */
const strandSection = document.getElementById("strandSection");
const specializationSection = document.getElementById("specializationSection");
const strands = [
  {code:"HUMSS", name:"Humanities and Social Sciences (HUMSS)"},
  {code:"ABM", name:"Accountancy, Business, Management (ABM)"},
  {code:"STEM", name:"Science, Technology, Engineering, Math (STEM)"},
  {code:"TVL", name:"Technical-Vocational-Livelihood (TVL)"}
];
strands.forEach(strand=>{
  strandSection.innerHTML += `<label><input type="radio" name="strand" value="${strand.code}"> ${strand.name}</label>`;
});

/* SPECIALIZATIONS */
const specializations = {
  "AFA":"Agri-Fishery Arts (AFA)",
  "HE":"Home Economics (HE)",
  "IA":"Industrial Arts (IA)",
  "ICT":"Information and Communication Technology (ICT)"
};
const ictNested = {
  "CP":"Computer Programming (CP)",
  "CSS":"Computer Systems Servicing (CSS)"
};

document.querySelectorAll('input[name="strand"]').forEach(radio=>{
  radio.addEventListener("change", function(){
    specializationSection.innerHTML = "";
    document.querySelectorAll('.nested-specialization').forEach(el=>el.style.display='none');
    if(this.value==="TVL"){
      specializationSection.innerHTML = "<h3>Specialization</h3>";
      Object.keys(specializations).forEach(sp=>{
        const spLabel = document.createElement("label");
        spLabel.innerHTML = `<input type="radio" name="specialization" value="${sp}"> ${specializations[sp]}`;
        specializationSection.appendChild(spLabel);

        if(sp==="ICT"){
          const nestedDiv = document.createElement("div");
          nestedDiv.className="nested-specialization";
          Object.keys(ictNested).forEach(opt=>{
            nestedDiv.innerHTML += `<label><input type="radio" name="ictSpecialization" value="${opt}"> ${ictNested[opt]}</label>`;
          });
          spLabel.appendChild(nestedDiv);
          spLabel.querySelector('input[type="radio"]').addEventListener('change', ()=>{
            nestedDiv.style.display='block';
          });
        }
      });
    }
  });
});

/* SUBMIT FORM */
document.getElementById("shsForm").addEventListener("submit", async e=>{
  e.preventDefault();
  const lrn = document.getElementById("lrn").value.trim();
  const q = query(collection(db,"applications"),where("lrn","==",lrn));
  const snapshot = await getDocs(q);
  if(!snapshot.empty){ alert("This LRN is already registered!"); return; }

  const strandValue = document.querySelector('input[name="strand"]:checked')?.value || "";
  let specializationValue = "None";
  if(strandValue==="TVL"){
    const spSelected = document.querySelector('input[name="specialization"]:checked');
    specializationValue = spSelected ? specializations[spSelected.value] : "None";
    if(spSelected?.value==="ICT"){
      const ictOpts = Array.from(document.querySelectorAll('input[name="ictSpecialization"]:checked')).map(i=>ictNested[i.value]);
      specializationValue += ictOpts.length ? " ("+ictOpts.join(", ")+")" : "";
    }
  }

  const data = {
    lrn,
    givenName: givenName.value,
    middleName: middleName.value,
    surname: surname.value,
    dob: dob.value,
    birthPlace: birthPlace.value,
    sex: sex.value,
    email: email.value,
    phone: phone.value,
    location:{
      barangay:barangay.value,
      city:city.value,
      province:province.value,
      region:region.value,
      zip:zip.value
    },
    strand: strandValue,
    specialization: specializationValue
  };

  try{
    await addDoc(collection(db,"applications"),data);
    // Disable entire form
    document.getElementById("shsForm").querySelectorAll("input, select, button").forEach(el => el.disabled = true);
    alert("Enrollment successful!");
    // Redirect to profile page
    window.location.href = `profile.html?lrn=${lrn}`;
  }catch(err){alert("Error: "+err.message);}
});
</script>
</body>
</html>

  padding: 30px;
  margin: 30px 0;
  box-shadow:0 6px 20px rgba(0,0,0,0.3);
}
.header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
}
.header h2{margin:0;color:#2c3e50;}
.logout-btn {
  padding:8px 15px;
  border:none;
  background-color:#e74c3c;
  color:#fff;
  font-weight:bold;
  border-radius:6px;
  cursor:pointer;
  transition:0.3s;
}
.logout-btn:hover{background-color:#c0392b;}
.user-info {
  display:flex;
  align-items:center;
  gap:10px;
  margin-bottom:25px;
  background:linear-gradient(90deg,#3498db,#9b59b6);
  padding:10px 15px;
  border-radius:8px;
  color:#fff;
}
.user-info img {width:40px;border-radius:50%;border:2px solid #fff;}
form label{font-weight:bold;margin-top:10px;display:block;color:#2c3e50;}
form input, form select {
  width:100%; padding:10px;margin-top:5px;border-radius:6px;border:1px solid #3498db;box-sizing:border-box;transition:0.3s;
}
form input:focus, form select:focus{border-color:#9b59b6;outline:none;}
form button{
  margin-top:20px;
  background:linear-gradient(90deg,#3498db,#9b59b6);
  color:#fff;font-weight:bold;border:none;cursor:pointer;border-radius:8px;transition:0.3s;
}
form button:hover{
  background:linear-gradient(90deg,#2980b9,#8e44ad);
}
#photo-preview img{
  width:120px;
  margin-top:10px;
  border-radius:6px;
  border:2px solid #3498db;
}
h3 {margin-top:20px;color:#2c3e50;border-bottom:1px solid #ccc;padding-bottom:5px;}
</style>
</head>
<body>

<div class="container">

  <div class="header">
    <h2>Applicant Profile</h2>
    <button class="logout-btn" id="logout">Logout</button>
  </div>

  <!-- Google User Info -->
  <div class="user-info">
    <img id="user-photo" src="logo.jpg" alt="User Photo">
    <h2>ADMISSION FORM</h2>
  </div>

  <form id="applicantForm">
    <h3>Personal Information</h3>

    <label>LRN</label>
    <input type="text" id="lrn" placeholder="12-digit LRN" pattern="[0-9]{12}" maxlength="12" required>

    <label>Given Name</label>
    <input type="text" id="givenName" placeholder="Given Name" required>

    <label>Middle Name</label>
    <input type="text" id="middleName" placeholder="Middle Name">

    <label>Surname</label>
    <input type="text" id="surname" placeholder="Surname" required>

    <label>Date of Birth</label>
    <input type="date" id="dob" required>

    <label>Place of Birth</label>
    <input type="text" id="birthPlace" placeholder="Place of Birth" required>

    <label>Sex</label>
    <select id="sex" required>
      <option value="">Select Gender</option>
      <option value="Male">Male</option>
      <option value="Female">Female</option>
    </select>

    <label>Email</label>
    <input type="email" id="email" placeholder="Email" required>

    <label>Phone Number</label>
    <input type="text" id="phone" placeholder="Phone Number" required>

    <h3>Address</h3>
    <label>Street / Subdivision</label>
    <input type="text" id="street" placeholder="Street / Subdivision" required>

    <label>House Number</label>
    <input type="text" id="houseNumber" placeholder="House Number" required>

    <label>Province / Region</label>
    <input type="text" id="province" placeholder="Province / Region" required>

    <label>Zip Code</label>
    <input type="text" id="zip" placeholder="Zip Code" required>

    <label>Course</label>
    <select id="course" required>
      <option value="">Select Course</option>
      <option value="STEM">STEM</option>
      <option value="TVL">TVL</option>
      <option value="HUMSS">HUMSS</option>
      <option value="ABM">ABM</option>
    </select>

    <label>Track</label>
    <select id="track" required>
      <option value="">Select Track</option>
    </select>

    <label>Upload 2x2 Photo</label>
    <input type="file" id="photo-upload" accept="image/*">
    <div id="photo-preview"></div>

    <button type="submit">Submit Profile</button>
  </form>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, query, where, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyBd0qUeuZr68Cf10bomf0mQEcjuNaE6Krs",
  authDomain: "admissionportal-ec954.firebaseapp.com",
  projectId: "admissionportal-ec954",
  storageBucket: "admissionportal-ec954.appspot.com",
  messagingSenderId: "182457612989",
  appId: "1:182457612989:web:dcaa6939ea96cd5f8cd5d4"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Logout
document.getElementById('logout').addEventListener('click', ()=>{ alert('Logged out!'); window.location.href='index.html'; });

// Photo preview
document.getElementById('photo-upload').addEventListener('change', e=>{
  const file=e.target.files[0]; const preview=document.getElementById('photo-preview'); preview.innerHTML='';
  if(file){const reader=new FileReader(); reader.onload=function(event){const img=document.createElement('img'); img.src=event.target.result; preview.appendChild(img); }
  reader.readAsDataURL(file);}
});

// Dynamic Track based on Course
const courseSelect=document.getElementById('course');
const trackSelect=document.getElementById('track');
const courseTracks = { 'TVL':['HE','CP','CSS','IA'], 'STEM':['Science','Math','Engineering'], 'HUMSS':['Social Science','Humanities'], 'ABM':['Accounting','Business','Management']};
courseSelect.addEventListener('change',()=>{
  const selectedCourse = courseSelect.value;
  trackSelect.innerHTML='<option value="">Select Track</option>';
  if(courseTracks[selectedCourse]){
    courseTracks[selectedCourse].forEach(track=>{ const opt=document.createElement('option'); opt.value=track; opt.textContent=track; trackSelect.appendChild(opt); });
  }
});

// Submit form with single registration per LRN
document.getElementById('applicantForm').addEventListener('submit', async e=>{
  e.preventDefault();
  const lrnVal = document.getElementById('lrn').value.trim();
  if(!lrnVal){ alert("Please enter your LRN."); return; }

  const q = query(collection(db,'applications'),where('lrn','==',lrnVal));
  const querySnapshot = await getDocs(q);
  if(!querySnapshot.empty){ alert("This LRN is already registered!"); return; }

  const data={
    lrn: lrnVal,
    givenName: document.getElementById('givenName').value,
    middleName: document.getElementById('middleName').value,
    surname: document.getElementById('surname').value,
    dob: document.getElementById('dob').value,
    birthPlace: document.getElementById('birthPlace').value,
    sex: document.getElementById('sex').value,
    email: document.getElementById('email').value,
    phone: document.getElementById('phone').value,
    street: document.getElementById('street').value,
    houseNumber: document.getElementById('houseNumber').value,
    province: document.getElementById('province').value,
    zip: document.getElementById('zip').value,
    course: document.getElementById('course').value,
    track: document.getElementById('track').value,
    photo: document.getElementById('photo-preview').querySelector('img')?.src || ''
  };

  try{
    await addDoc(collection(db,'applications'),data);
    alert('Profile submitted successfully!');
    e.target.reset(); document.getElementById('photo-preview').innerHTML='';
  }catch(err){ alert('Error saving: '+err.message);}
});
</script>

</body>
</html>



